## Codebase Patterns
- Shell scripts go in scripts/unity/ for sandbox scripts, scripts/ for project-level scripts
- All shell scripts must start with #!/bin/bash and set -euo pipefail
- Docker image: unityci/editor:ubuntu-${UNITY_VERSION}-${UNITY_PLATFORM}-${GAMECI_VERSION} pattern
- ARGs must be declared BEFORE FROM to be usable in FROM
- No GUI packages — xvfb, vnc, fluxbox, xdotool are BANNED
- PostgreSQL for DreamForge must use port 5433 (not 5432)
- All env vars in docker-compose: ${VAR:-default} syntax
- Scripts copied to / root in Dockerfile: /unity-init.sh, /compile-watcher.sh, /unity-compile.sh

# Ralph Progress Log
Started: 2026-02-28
---

## 2026-02-28 - US-001
- Implemented Dockerfile.unity-sandbox with GameCI base image, headless deps, Node.js 22 LTS, TOS pre-accept
- Created placeholder scripts in scripts/unity/: unity-init.sh, compile-watcher.sh, unity-compile.sh
- All bash -n syntax checks pass
- Dockerfile structure validated (FROM, RUN, COPY, ARG, LABEL, WORKDIR all correct)
- **Learnings for future iterations:**
  - ARG before FROM is required for variables used in FROM instruction
  - unity-init.sh looks for compile-watcher at /unity-compile-watcher.sh OR /compile-watcher.sh (both checked)
  - inotifywait from inotify-tools is used in compile-watcher for file monitoring
  - TOS pre-accept: /root/.config/unity3d/Unity/TOS.json with {"v":1,"accepted":true}
---

## 2026-02-28 - US-002
- Verified scripts/unity/unity-init.sh meets all acceptance criteria (was fully implemented in US-001)
- All criteria satisfied: git clone with GIT_REPO_URL/GIT_BRANCH, license via .ulf + UNITY_SERIAL, batchmode init, compile-watcher background start, no GUI packages, informative echo messages
- bash -n scripts/unity/unity-init.sh passes
- **Learnings for future iterations:**
  - US-001 agent created fully-implemented scripts, not just placeholders — US-002/003/004 are verification+marking stories
  - License activation order: .ulf file path first, then UNITY_SERIAL (with UNITY_EMAIL + UNITY_PASSWORD), then TOS-only fallback
  - Compile-watcher looked up at both /unity-compile-watcher.sh and /compile-watcher.sh for resilience
---
